# 100 iid random variables from a nor- mal distribution with mean 5 and standard deviation 2.
random_normal_distribution <- rnorm(1000, 5, 2)
ggplot(data.frame(x = random_normal_distribution)) +aes(x) + geom_histogram(fill="grey60")
ggplot(data.frame(x = random_normal_distribution)) +aes(x) + geom_histogram(fill="grey60", bins = 50)
quantile(random_normal_distribution, 0.95)
library(tidyverse)
# 100 iid random variables from a nor- mal distribution with mean 5 and standard deviation 2.
random_normal_distribution <- rnorm(1000, 5, 2)
ggplot(data.frame(x = random_normal_distribution)) +aes(x) + geom_histogram(fill="grey60", bins = 50)
# 0.95th quantile of the random distribution.
quantile(random_normal_distribution, 0.95)
pbinom(q=20, size=50, prob=0.3)
?pbinom
pbinom(x=20, size=50, prob=0.3)
pbinom(x=20, size=50, prob=0.3)
dbinom(x=20, size=50, prob=0.3)
dpois(x=2, lambda=5)
# Read in population estimates for East Anglia for the 2004-2017 period.
pop_0417 <- read_csv("../Data/pop_ea_200417.csv")
# Population estimates
# Read in population estimates for East Anglia for the 2004-2017 period.
pop_0417 <- read_csv("../Data/pop_ea_200417.csv")
# Initialise required packages.
required_packages <- c('tidyverse', 'readxl')
# Install and load required packages.
for (p in mypackages) {
if (!require(p, character.only = TRUE)) {
install.packages(p)
library(p, character.only = TRUE)
}
}
# Initialise required packages.
required_packages <- c('tidyverse', 'readxl')
# Install and load required packages.
for (p in required_packages) {
if (!require(p, character.only = TRUE)) {
install.packages(p)
library(p, character.only = TRUE)
}
}
# Population estimates
# Read in population estimates for East Anglia for the 2004-2017 period.
pop_0417 <- read_csv("../Data/pop_ea_200417.csv")
# Set working directory.
setwd("/Users/rafaelkoll/Desktop/4/Masters/c/Course/ADA/Practical")
pop_7117
# Load female breast cancer incidence rate files.
# POPULATION ESTIMATES.
# Read in population estimates for East Anglia for the 2004-2017 period.
pop_0417 <- read_csv("../Data/pop_ea_200417.csv")
getwd()
# POPULATION ESTIMATES.
# Read in population estimates for East Anglia for the 2004-2017 period.
pop_0417 <- read_csv("./Data/pop_ea_200417.csv")
# Read in population estimates for East Anglia for the 1971-2003 period.
pop_7103 <-
readr::read_table(
"./Data/population.txt",
col_names = c("year", "sex", "age", "population"),
skip = 5
)
# Create a tibble that combines the population estimates for the two different
# periods, from 1971 to 2017.
pop_7117 <- bind_rows(pop_0417, pop_7103)
pop_7117
pop_7103
pop_0417
pop_7117
View(pop_7117)
pop_7117
pop_8017 <- filter(pop_7117, year > 1980)
pop_8017 <- filter(pop_7117, year >= 1980)
pop_8017
View(pop_8017)
pop_8017 <-
read_csv("./Data/pop_ea_200417.csv") %>% bind_rows(readr::read_table(
"./Data/population.txt",
col_names = c("year", "sex", "age", "population"),
skip = 5
)) %>% filter(year >= 1980, sex == 2)
pop_8017
View(pop_8017)
?read_excel
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19)
cases_0417
View(cases_0417)
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19)
cases_0417
cases_0417 <- cases_0417 %>% pivot_longer(cols = 1:ncol(cases_0417), names_to = "year",
values_to = "cases") %>% arrange(year)
# Load age-specific incidence rate of our population.
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19)
cases_0417 <- cases_0417 %>% select(everything(), -1, -last_col())
# Function that returns the age band.
get_age_band <- function(age) {
return(cut(age, breaks = seq(0,85,5), labels=seq(1,17), right = TRUE))
}
# use mutate() to create a new variable called age_gp which has values 1-17 for the five-year age bands from 0-85
# and value 18 for age 85+.
case_con_bands <- case_con %>% mutate(age_gp = ifelse(age <= 85, get_age_band(age), 18)) %>% select(age_gp, everything())
# Load age-specific incidence rate of our population.
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19)
cases_0417 <- cases_0417 %>% select(everything(), -1, -last_col())
cases_0417
# Load age-specific incidence rate of our population.
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19)
cases_0417
cases_0417 <- cases_0417 %>% pivot_longer(cols = 1:ncol(cases_0417), names_to = "year",
values_to = "cases") %>% arrange(year)
View(cases_0417)
cases_0417 <- cases_0417 %>% select(everything(), -1, -last_col())
cases_0417
case_con_bands <- cases_0417 %>% mutate(age_gp = ifelse(age <= 85, get_age_band(age), 18)) %>% select(age_gp, everything())
cases_0417 <- cases_0417 %>% pivot_longer(cols = 1:ncol(cases_0417), names_to = "year",
values_to = "cases") %>% arrange(year)
cases_0417
View(cases_0417)
cases_0417 <-
read_excel(
"../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip = 3,
n_max = 19
) %>% select(everything(),-1,-last_col()) %>% pivot_longer(
cols = 1:ncol(cases_0417),
names_to = "year",
values_to = "cases"
) %>% arrange(year)
cases_0417
cases_0417 <- read_excel(
"../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip = 3,
n_max = 19
)
cases_0417 <-
cases_0417 %>% select(everything(), -1, -last_col()) %>% pivot_longer(
cols = 1:ncol(cases_0417),
names_to = "year",
values_to = "cases"
) %>% arrange(year)
cases_0417
cases_0417 <- read_excel(
"../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip = 3,
n_max = 19
)
cases_0417 <-
cases_0417 %>% select(everything(), -1, -last_col()) %>% pivot_longer(
cols = 1:ncol(cases_0417),
names_to = "year",
values_to = "cases"
) %>% arrange(year)
cases_0417 <- cases_0417 %>% select(everything(), -1, -last_col()) %>% pivot_longer(
cols = 1:ncol(cases_0417),
names_to = "year",
values_to = "cases"
) %>% arrange(year)
cases_0417
cases_0417 <- cases_0417 %>% select(everything(), -1, -last_col()) %>% pivot_longer(
cols = 1:17,
names_to = "year",
values_to = "cases"
) %>% arrange(year)
cases_0417 <- read_excel(
"../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip = 3,
n_max = 19
)
cases_0417 <- cases_0417 %>% select(everything(), -1, -last_col())
cases_0417 <- cases_0417 %>% pivot_longer(
cols = 1:17,
names_to = "year",
values_to = "cases"
) %>% arrange(year)
# Load age-specific incidence rate of our population.
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19)
# Exclude the first and last columns.
cases_0417 <- cases_0417 %>% select(everything(), -1, -last_col())
cases_0417 <- cases_0417 %>% pivot_longer(cols = 1:ncol(cases_0417), names_to = "year",
values_to = "cases") %>% arrange(year)
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19) %>% select(everything(), -1, -last_col())
cases_0417 <- cases_0417 %>% pivot_longer(cols = 1:ncol(cases_0417), names_to = "year",
values_to = "cases") %>% arrange(year)
cases_0417
View(cases_0417)
View(pop_0417)
cases_8003 <- read.csv("../Data files - lecture4/tumour.tsv", sep = '\t')
cases_8003
View(cases_8003)
cases_8003 <- tumour %>% mutate(date_of_diagnosis = dmy(date_of_diagnosis))
cases_8003 <- cases_8003 %>% mutate(date_of_diagnosis = dmy(date_of_diagnosis))
# Initialise required packages.
required_packages <- c('tidyverse', 'readxl', 'lubridate')
# Install and load required packages.
for (p in required_packages) {
if (!require(p, character.only = TRUE)) {
install.packages(p)
library(p, character.only = TRUE)
}
}
# Read in the incidence rate for 1980 until 2003.
cases_8003 <- read.csv("../Data files - lecture4/tumour.tsv", sep = '\t')
cases_8003 <- cases_8003 %>% mutate(date_of_diagnosis = dmy(date_of_diagnosis))
cases_8003
cases_0417
View(cases_0417)
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19) %>% select(everything(), -1, -last_col())
cases_0417
# Convert wide table to longer.
cases_0417 <- cases_0417 %>% pivot_longer(cols = 1:ncol(cases_0417), names_to = "year",
values_to = "cases") %>% arrange(year)
cases_0417
cases_8003
?pivot_longer
# Convert wide table to longer.
cases_0417 <- cases_0417 %>% pivot_longer(cols = 1:ncol(cases_0417), names_to = "year",
values_to = "cases") %>% arrange(year)
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19) %>% select(everything(), -1, -last_col())
cases_0417
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19) %>% select(everything(), -1, -last_col())
cases_0417
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19) %>% select(everything(), -1, -last_col())
# Load age-specific incidence rate of our population.
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19)
cases_0417
cases_0417[18]
cases_0417[,18]
cases_0417[18,]
cases_0417[18,] + cases_0417[19,]
cases_0417[19,]
colSums(cases_0417[,c(18, 19)])
?colSums
?colSums()
cases_0417[,18] <- cases_0417 %>% select(., 18:19) %>% rowSums(na.rm = TRUE)
cases_0417[,18]
cases_0417[18,] <- cases_0417 %>% select(18:19,) %>% colSums(na.rm = TRUE)
cases_0417[18,] <- cases_0417 %>% select(18:19,.) %>% colSums(na.rm = TRUE)
cases_0417[18,] <- cases_0417 %>% select(18:19, ) %>% colSums(na.rm = TRUE)
cases_0417
cases_0417[18,]
cases_0417[[18,]]
cases_0417[[18]]
cases_0417
as.numeric(as.vector(cases_0417[,18]))
as.numeric(as.vector(cases_0417[18,]))
cases_0417
?as.numeric
?as.vector
as.numeric(as.vector(cases_0417[18,]))[1:]
xt <-as.numeric(as.vector(cases_0417[18,]))
xt
xt[0]
xt[1]
xt[2]
xt[2:length(xt)]
xt <- xt[2:length(xt)]
xt
xd <-as.numeric(as.vector(cases_0417[19,]))[2:length(xd)]
xd <-as.numeric(as.vector(cases_0417[19,])) %>% [2:length]
xd <-as.numeric(as.vector(cases_0417[19,])) %>% [2:length()]
xd <-as.numeric(as.vector(cases_0417[19,]))
xd <- xd[2:length()]
xd
xd <- xd[2:length(xd)]
xd
xt+xd
as.numeric(as.vector(cases_0417[18,1:]))
as.numeric(as.vector(cases_0417[18,1::]))
as.numeric(as.vector(cases_0417[18,1]))
as.numeric(as.vector(cases_0417[18,2:]))
age_85_85 <- as.numeric(as.vector(cases_0417[18,2:ncol(cases_0417)]))
age_90_over <- as.numeric(as.vector(cases_0417[18,2:ncol(cases_0417)]))
age_85_89 <- as.numeric(as.vector(cases_0417[18,2:ncol(cases_0417)]))
age_85_89
cases_0417 <- cases_0417 %>% mutate(cases_0417[18,] = age_85_89 + age_90_over)
cases_0417
cases_0417[18,] <- age_85_89 + age_90_over
cases_0417
age_85_89 + age_90_over
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19) %>% select(everything(), -1, -last_col())
age_85_89 <- as.numeric(as.vector(cases_0417[18,2:ncol(cases_0417)]))
age_90_over <- as.numeric(as.vector(cases_0417[18,2:ncol(cases_0417)]))
cases_0417[18,] <- age_85_89 + age_90_over
cases_0417
age_85_89
age_85_89 <- as.numeric(as.vector(cases_0417[18,])
age_90_over <- as.numeric(as.vector(cases_0417[18,]))
age_85_89 <- as.numeric(as.vector(cases_0417[18,]))
age_90_over <- as.numeric(as.vector(cases_0417[18,]))
age_85_89
cases_0417[18,] <- age_85_89 + age_90_over
cases_0417[18,]
cases_0417[18,] <- age_85_89
?rows_update
data <- tibble(a = 1:3, b = letters[c(1:2, NA)], c = 0.5 + 0:2)
data
rows_update(data, tibble(a = 2:3, b = "z"))
rows_update(data, tibble(b = "z", a = 2:3), by = "a")
cases_0417[18,] <- as.numeric(as.vector(cases_0417[18,])) + age_90_over
cases_0417[18,] <- cases_0417[18,] + 1
cases_0417
cases_0417[18,] <- cases_0417[18,] + age_90_over
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19) %>% select(everything(), -1, -last_col())
# add the numbers in the last row (90+ label) with the numbers in the previous to last
# since our age bands in the standard population are 1-18, with the 18th including everyone 85+.
age_90_over <- as.numeric(as.vector(cases_0417[18,]))
cases_0417[18,] <- cases_0417[18,] + age_90_over
cases_0417
cases_0417
cases_0417[1:18,]
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19) %>% select(everything(), -1, -last_col())
# add the numbers in the last row (90+ label) with the numbers in the previous to last
# since our age bands in the standard population are 1-18, with the 18th including everyone 85+.
age_90_over <- as.numeric(as.vector(cases_0417[18,]))
cases_0417[18,] <- cases_0417[18,] + age_90_over
# After merging, drop the last column (over 90), since the data is now on the column for 85+.
cases_0417 <- cases_0417[1:18]
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19) %>% select(everything(), -1, -last_col())
# add the numbers in the last row (90+ label) with the numbers in the previous to last
# since our age bands in the standard population are 1-18, with the 18th including everyone 85+.
age_90_over <- as.numeric(as.vector(cases_0417[18,]))
cases_0417[18,] <- cases_0417[18,] + age_90_over
cases_0417
cases_0417 <- cases_0417[1:18,]
cases_0417
# Convert wide table to longer.
cases_0417 <- cases_0417 %>% pivot_longer(cols = 1:ncol(cases_0417), names_to = "year",
values_to = "cases") %>% arrange(year)
cases_0417
# Initialise required packages.
required_packages <- c('tidyverse', 'readxl', 'lubridate')
# Install and load required packages.
for (p in required_packages) {
if (!require(p, character.only = TRUE)) {
install.packages(p)
library(p, character.only = TRUE)
}
}
# Set working directory - please change accordingly.
setwd("/Users/rafaelkoll/Desktop/4/Masters/c/Course/ADA/Practical")
# POPULATION ESTIMATES - STANDARD POPULATION.
# Read in the population estimates files for East Anglia for the 2004-2017 and 1971-2003
# periods. Then combine the two using bind_rows, and finally filter the
# result to include data from 1980 until 2017, and only female (sex=2).
pop_8017 <-
read_csv("./Data/pop_ea_200417.csv") %>% bind_rows(readr::read_table(
"./Data/population.txt",
col_names = c("year", "sex", "age", "population"),
skip = 5
)) %>% filter(year >= 1980, sex == 2)
# Initialise required packages.
required_packages <- c('tidyverse', 'readxl', 'lubridate')
# Install and load required packages.
for (p in required_packages) {
if (!require(p, character.only = TRUE)) {
install.packages(p)
library(p, character.only = TRUE)
}
}
# Set working directory - please CHANGE ACCORDINGLY.
setwd("/Users/rafaelkoll/Desktop/4/Masters/c/Course/ADA/Practical/Breast-cancer-incidence-analysis")
# POPULATION ESTIMATES - STANDARD POPULATION.
# Read in the population estimates files for East Anglia for the 2004-2017 and 1971-2003
# periods. Then combine the two using bind_rows, and finally filter the
# result to include data from 1980 until 2017, and only female (sex=2).
pop_8017 <-
read_csv("./Data/pop_ea_200417.csv") %>% bind_rows(readr::read_table(
"./Data/population.txt",
col_names = c("year", "sex", "age", "population"),
skip = 5
)) %>% filter(year >= 1980, sex == 2)
# INCIDENCE RATE OF OUR POPULATION
# Load age-specific incidence rate of our population.
cases_0417 <- read_excel("../Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19) %>% select(everything(), -1, -last_col())
# Initialise required packages.
required_packages <- c('tidyverse', 'readxl', 'lubridate')
# Install and load required packages.
for (p in required_packages) {
if (!require(p, character.only = TRUE)) {
install.packages(p)
library(p, character.only = TRUE)
}
}
# Set working directory - please CHANGE ACCORDINGLY.
setwd("/Users/rafaelkoll/Desktop/4/Masters/c/Course/ADA/Practical/Breast-cancer-incidence-analysis")
# POPULATION ESTIMATES - STANDARD POPULATION.
# Read in the population estimates files for East Anglia for the 2004-2017 and 1971-2003
# periods. Then combine the two using bind_rows, and finally filter the
# result to include data from 1980 until 2017, and only female (sex=2).
pop_8017 <-
read_csv("./Data/pop_ea_200417.csv") %>% bind_rows(readr::read_table(
"./Data/population.txt",
col_names = c("year", "sex", "age", "population"),
skip = 5
)) %>% filter(year >= 1980, sex == 2)
# INCIDENCE RATE OF OUR POPULATION
# Load age-specific incidence rate of our population.
cases_0417 <- read_excel("./Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19) %>% select(everything(), -1, -last_col())
# Initialise required packages.
required_packages <- c('tidyverse', 'readxl', 'lubridate')
# Install and load required packages.
for (p in required_packages) {
if (!require(p, character.only = TRUE)) {
install.packages(p)
library(p, character.only = TRUE)
}
}
# Set working directory - please CHANGE ACCORDINGLY.
setwd("/Users/rafaelkoll/Desktop/4/Masters/c/Course/ADA/Practical/Breast-cancer-incidence-analysis")
# POPULATION ESTIMATES - STANDARD POPULATION.
# Read in the population estimates files for East Anglia for the 2004-2017 and 1971-2003
# periods. Then combine the two using bind_rows, and finally filter the
# result to include data from 1980 until 2017, and only female (sex=2).
pop_8017 <-
read_csv("./Data/pop_ea_200417.csv") %>% bind_rows(readr::read_table(
"./Data/population.txt",
col_names = c("year", "sex", "age", "population"),
skip = 5
)) %>% filter(year >= 1980, sex == 2)
# INCIDENCE RATE OF OUR POPULATION
# Load age-specific incidence rate of our population.
cases_0417 <- read_excel("./Data files - lecture4/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19) %>% select(everything(), -1, -last_col())
# Initialise required packages.
required_packages <- c('tidyverse', 'readxl', 'lubridate')
# Install and load required packages.
for (p in required_packages) {
if (!require(p, character.only = TRUE)) {
install.packages(p)
library(p, character.only = TRUE)
}
}
# Set working directory - please CHANGE ACCORDINGLY.
setwd("/Users/rafaelkoll/Desktop/4/Masters/c/Course/ADA/Practical/Breast-cancer-incidence-analysis")
# POPULATION ESTIMATES - STANDARD POPULATION.
# Read in the population estimates files for East Anglia for the 2004-2017 and 1971-2003
# periods. Then combine the two using bind_rows, and finally filter the
# result to include data from 1980 until 2017, and only female (sex=2).
pop_8017 <-
read_csv("./Data/pop_ea_200417.csv") %>% bind_rows(readr::read_table(
"./Data/population.txt",
col_names = c("year", "sex", "age", "population"),
skip = 5
)) %>% filter(year >= 1980, sex == 2)
# INCIDENCE RATE OF OUR POPULATION
# Load age-specific incidence rate of our population.
cases_0417 <- read_excel("./Data/brca_incidence_2004_17.xlsx",
skip=3,
n_max=19) %>% select(everything(), -1, -last_col())
# add the numbers in the last row (90+ label) with the numbers in the previous to last
# since our age bands in the standard population are 1-18, with the 18th including everyone 85+.
age_90_over <- as.numeric(as.vector(cases_0417[18,]))
cases_0417[18,] <- cases_0417[18,] + age_90_over
# After merging, drop the last column (over 90), since the data is now on the column for 85+.
cases_0417 <- cases_0417[1:18,]
# Convert wide table to longer.
cases_0417 <- cases_0417 %>% pivot_longer(cols = 1:ncol(cases_0417), names_to = "year",
values_to = "cases") %>% arrange(year)
# Read in the incidence rate for 1980 until 2003.
cases_8003 <- read.csv("./Data/tumour.tsv", sep = '\t')
cases_8003 <- cases_8003 %>% mutate(date_of_diagnosis = dmy(date_of_diagnosis))
# HAVE TO PROBABLY patient_number NUMBER WITH patient.csv FILE TO GET THEIR AGE.
cases_8003
cases_8003
cases_0417
View(cases_8003)
cases_8003 %>% summarise(number=n())
cases_8003 %>% group_by(date_of_diagnosis) %>% summarise(number=n())
cases_8003
cases_0417
cases_8003 <- cases_8003 %>% mutate(year = as.numeric(format(date,'%Y')))
cases_8003 <- cases_8003 %>% mutate(year = as.numeric(format(date_of_diagnosis,'%Y')))
cases_8003
cases_8003 <- cases_8003 %>% select(everything(), -date_of_diagnosis)
cases_8003
cases_8003 %>% group_by(year) %>% summarise(number=n())
